function Q = Qfunc(Qvals)
%  Calculate a chosen functional of the five quantities of interest
%
%  Qvals(1) = APD50
%  Qvals(2) = APD90
%  Qvals(3) = maximum upstroke
%  Qvals(4) = peak potential 
%  Qvals(5) = resting potential 
%

exptl_data=[
1.619742776	3.660943915	1130.876672	31.40822992	-84.52653335
1.616699309	3.653950626	1163.334645	31.54984372	-84.91322387
1.626117308	3.660970108	1158.670962	31.46169064	-84.5338256
1.623663183	3.647919317	1051.844385	31.41736242	-84.6949452
1.614362118	3.624342988	1188.004092	31.3960849	-84.64812827
1.628655067	3.652446416	1247.972666	31.34553147	-84.55984172
1.619555998	3.632315016	1283.246465	31.30779754	-84.51537789
1.616265565	3.653767088	1341.741455	31.2907353	-84.56030926
1.624417049	3.644420255	1107.205825	31.40133642	-84.58668872
1.626182023	3.648735338	1032.846709	31.29472313	-84.70982564
1.627447626	3.647777298	1077.820142	31.56060707	-84.49698743
1.619676117	3.667230292	1328.756847	31.3817907	-84.58114035
1.623612006	3.641448874	1123.648825	31.37782459	-84.62217299
1.6233328	3.636579189	1178.552246	31.3899694	-84.52857769
1.61897405	3.640417774	1143.595139	31.51420783	-84.64467235
1.622061061	3.644412865	1040.280361	31.43666169	-84.53884426
1.623882261	3.65500666	1059.397081	31.48465406	-84.60975774
1.626084049	3.666080523	1157.069181	31.29126064	-84.52781666
1.614871658	3.622830399	1078.159408	31.58900767	-84.57542452
1.619698162	3.664942922	1126.446432	31.43977305	-84.55203274
1.623461527	3.680460004	1138.533988	31.38681531	-84.57127516
1.622893223	3.644618392	1055.773601	31.48511618	-84.69487423
1.618207286	3.652490333	1051.848634	31.41207518	-84.68309349
1.619012675	3.641226779	1338.113411	31.40020994	-84.52937385
1.624090632	3.663992577	1315.093429	31.51313333	-84.49213497];

Qindex=[1 4 5];                 %APD50, peak potential, rest potential
qvals(1:3)=Qvals(Qindex(1:3));
evals(1:25,1:3)=exptl_data(1:25,Qindex(1:3));

sum=zeros(1,25);
for ie = 1:25
    for j=1:3
        sum(ie)=sum(ie)+( (qvals(j)-evals(ie,j))/evals(ie,j) )^2;
    end   
    sum(ie)=sqrt(sum(ie));
end
Q=mean(sum);

end

