function [dgdp] = dgvec_dparam(t,x,p) 

xdim=length(x);
kdim=length(p);
dgdp = zeros(xdim,kdim+xdim); 

  dg1dp1 = 1.0/p(5)+1.0/p(1)^2*p(6)*x(1)*x(3)*(cos(pi*t*2.0)*p(7)+sin(pi*t*2.0)*p(8)+1.0);
  dg1dp2 = -1.0/p(2)^2*x(4);
  dg1dp3 = 0.0;
  dg1dp4 = 0.0;
  dg1dp5 = -p(1)*1.0/p(5)^2+1.0/p(5)^2*x(1);
  dg1dp6 = -(x(1)*x(3)*(cos(pi*t*2.0)*p(7)+sin(pi*t*2.0)*p(8)+1.0))/p(1);
  dg1dp7 = -(cos(pi*t*2.0)*p(6)*x(1)*x(3))/p(1);
  dg1dp8 = -(sin(pi*t*2.0)*p(6)*x(1)*x(3))/p(1);
  dg2dp1 = -1.0/p(1)^2*p(6)*x(1)*x(3)*(cos(pi*t*2.0)*p(7)+sin(pi*t*2.0)*p(8)+1.0);
  dg2dp2 = 0.0;
  dg2dp3 = 0.0;
  dg2dp4 = 1.0/p(4)^2*x(2);
  dg2dp5 = 1.0/p(5)^2*x(2);
  dg2dp6 = (x(1)*x(3)*(cos(pi*t*2.0)*p(7)+sin(pi*t*2.0)*p(8)+1.0))/p(1);
  dg2dp7 = (cos(pi*t*2.0)*p(6)*x(1)*x(3))/p(1);
  dg2dp8 = (sin(pi*t*2.0)*p(6)*x(1)*x(3))/p(1);
  dg3dp1 = 0.0;
  dg3dp2 = 0.0;
  dg3dp3 = 1.0/p(3)^2*x(3);
  dg3dp4 = -1.0/p(4)^2*x(2);
  dg3dp5 = 1.0/p(5)^2*x(3);
  dg3dp6 = 0.0;
  dg3dp7 = 0.0;
  dg3dp8 = 0.0;
  dg4dp1 = 0.0;
  dg4dp2 = 1.0/p(2)^2*x(4);
  dg4dp3 = -1.0/p(3)^2*x(3);
  dg4dp4 = 0.0;
  dg4dp5 = 1.0/p(5)^2*x(4);
  dg4dp6 = 0.0;
  dg4dp7 = 0.0;
  dg4dp8 = 0.0;

dgdp(1,1) = dg1dp1;
dgdp(1,2) = dg1dp2;
dgdp(1,3) = dg1dp3;
dgdp(1,4) = dg1dp4;
dgdp(1,5) = dg1dp5;
dgdp(1,6) = dg1dp6;
dgdp(1,7) = dg1dp7;
dgdp(1,8) = dg1dp8;
dgdp(2,1) = dg2dp1;
dgdp(2,2) = dg2dp2;
dgdp(2,3) = dg2dp3;
dgdp(2,4) = dg2dp4;
dgdp(2,5) = dg2dp5;
dgdp(2,6) = dg2dp6;
dgdp(2,7) = dg2dp7;
dgdp(2,8) = dg2dp8;
dgdp(3,1) = dg3dp1;
dgdp(3,2) = dg3dp2;
dgdp(3,3) = dg3dp3;
dgdp(3,4) = dg3dp4;
dgdp(3,5) = dg3dp5;
dgdp(3,6) = dg3dp6;
dgdp(3,7) = dg3dp7;
dgdp(3,8) = dg3dp8;
dgdp(4,1) = dg4dp1;
dgdp(4,2) = dg4dp2;
dgdp(4,3) = dg4dp3;
dgdp(4,4) = dg4dp4;
dgdp(4,5) = dg4dp5;
dgdp(4,6) = dg4dp6;
dgdp(4,7) = dg4dp7;
dgdp(4,8) = dg4dp8;

end